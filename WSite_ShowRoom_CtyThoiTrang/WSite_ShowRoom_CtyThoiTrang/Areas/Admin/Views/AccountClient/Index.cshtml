@model PagedList.IPagedList<WSite_ShowRoom_CtyThoiTrang.Models.tb_KhachHang>
@using PagedList.Mvc
@{
    ViewBag.Title = "Quản lý khách hàng";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";

}
@section naviheader{
    <!-- Left navbar links -->
    <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
        </li>
        <li class="nav-item d-none d-sm-inline-block">
            <a href="/admin" class="nav-link">Trang chủ</a>
        </li>
        <li class="nav-item d-none d-sm-inline-block">
            <a href="/admin/category" class="nav-link">@ViewBag.Title</a>
        </li>
    </ul>
}

<link href="~/Content/CSS/Admin/AccountClient.css" rel="stylesheet" />
<link rel="stylesheet" href="//code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">
<!-- Content Header (Page header) -->
<section class="content-header">
    <div class="container-fluid">
        <div class="row mb-2">
            <div class="col-sm-6">
                <h1>Quản lý khách hàng</h1>
            </div>
            <div class="col-sm-6">
                <ol class="breadcrumb float-sm-right">
                    <li class="breadcrumb-item"><a href="#">Home</a></li>
                    <li class="breadcrumb-item active">@ViewBag.Title</li>
                </ol>
            </div>
        </div>
    </div><!-- /.container-fluid -->
</section>

<section class="content">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="card-body">
                    <div class="main-box clearfix">
                        <div class="table-responsive">
                            <table class="table user-list">
                                <thead>
                                    <tr class="text-center">
                                        <th><input type="checkbox" id="SelectAll" /></th>
                                        <th><span>STT</span></th>
                                        <th><span>Hình</span></th>
                                        <th><span>Tên khách hàng</span></th>
                                        <th class="text-center"><span>SĐT</span></th>
                                  
                                        <th><span>Khóa</span></th>
                                        <th>Chi tiết</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @if (Model.Any() && Model != null)
                                    {
                                        var i = ((ViewBag.Page - 1) * ViewBag.PageSize) + 1;
                                        foreach (var item in Model)
                                        {
                                            var strClock = item.Clock.GetValueOrDefault() ? "<i class=\"fas fa-lock\"></i>" : "<i class=\"fas fa-lock-open\"></i>";
                                            <tr id="trow_@item.IdKhachHang" class="text-center"> 
                                                 
                                                <td><input type="checkbox" class="cbkItem" value="@item.IdKhachHang" /></td>
                                                <td>@i</td>
                                                <td class="text-center"     >
                                                    <img src="https://bootdey.com/img/Content/avatar/avatar1.png" >
                                                </td>
                                                <td>
                                                    @item.TenKhachHang
                                                </td>
                                               
                                                <td>
                                                    @*<a href="#"><span class="__cf_email__" data-cfemail="34595d5855745f415a5d471a575b59">[email&#160;protected]</span></a>*@
                                                    @item.SDT
                                                </td>
                                               
                                                <td>
                                                    <a href='#' data-id="@item.IdKhachHang" class="btnClock">@Html.Raw(strClock)</a>
                                                </td>
                                                <td>
                                                    <a href='/admin/accountclient/detail/@item.IdKhachHang' class="btn btn-success">Xem</a>
                                                </td>
                                            </tr>
                                            i++;
                                        }


                                    }
                                    else
                                    {
                                        <p class="text-danger">Chưa có khách hàng</p>
                                    }



                                </tbody>
                            </table>
                        </div>
                       
                    </div>
                </div>
                
            </div>
        </div>
    </div>
</section>

@section scripts{
    <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>
    <script>
        $(document).ready(function () {
            $('body').on('change', '#SelectAll', function () {
                var checkStatus = this.checked;
                var checkbox = $(this).parents('.card-body').find('tr td input:checkbox');
                checkbox.each(function () {
                    this.checked = checkStatus;
                    if (this.checked) {
                        checkbox.attr('selected', 'checked');
                    } else {
                        checkbox.attr('selected', '');
                    }
                });
            });

            $('body').on('click', '.btnClock', function () {
                var id = $(this).data("id");
               
                var conf = confirm('Bạn có muốn khóa tài khoản này');
                if (conf === true) {
                    $.ajax({
                        url: '/admin/AccountClient/IsLock',
                        type: 'POST',
                        data: { id: id },
                        success: function (rs) {
                            if (rs.success) {
                                if (rs.Clock) {
                                   
                                    location.reload(true);
                                    btn.html("<i class=\"fas fa-lock\"></i>");
                                }
                                else {
                                    location.reload(true);
                                    btn.html("<i class=\"fas fa-lock-open\"></i>");
                                  
                                }
                            }
                        }
                    });
                }
            });



           



        });
    </script>

}




